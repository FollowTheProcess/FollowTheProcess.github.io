<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --accent-color: #FF4D4D;
        }
    </style>

    
    
    
    
    
    

    
    <title>Automate your Virtual Environments... and everything else.</title>
    <meta name="description" content="Because why not?">
    <meta name="keywords" content='python, virtual environments, automation'>

    <meta property="og:url" content="https://followtheprocess.github.io/posts/auto_venv/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Automate your Virtual Environments... and everything else.">
    <meta property="og:description" content="Because why not?">
    <meta property="og:image" content="/images/profile.jpg">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Automate your Virtual Environments... and everything else.">
    <meta name="twitter:description" content="Because why not?">
    <meta property="twitter:domain" content="https://followtheprocess.github.io/posts/auto_venv/">
    <meta property="twitter:url" content="https://followtheprocess.github.io/posts/auto_venv/">
    <meta name="twitter:image" content="/images/profile.jpg">

    
    <link rel="canonical" href="https://followtheprocess.github.io/posts/auto_venv/" />

    <link rel="stylesheet" type="text/css" href="/css/normalize.min.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" type="text/css" href="/css/main.css">
    <link disabled id="dark-theme" rel="stylesheet" href="/css/dark.css">

    <script src="/js/svg-injector.min.js"></script>
    <script src="/js/feather-icons.min.js"></script>
    <script src="/js/main.js"></script>

    
    
        <!-- KaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css" integrity="sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET" crossorigin="anonymous">

    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js" integrity="sha384-GxNFqL3r9uRJQhR+47eDxuPoNE7yLftQM8LcxzgS4HT73tp970WS/wV5p8UzCOmb" crossorigin="anonymous"></script>

    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
        onload="renderMathInElement(document.body,);"></script>
  
    
</head>
<body>
        <script type="text/javascript">
            
            setThemeByUserPref();
        </script><header class="header">
    <nav class="header-nav">

        
        <div class="avatar">
            <a href="https://followtheprocess.github.io">
                <img src="/images/profile.jpg" alt="avatar" />
            </a>
        </div>
        

        <div class="nav-title">
            <a class="nav-brand" href="https://followtheprocess.github.io">@FollowTheProcess</a>
        </div>

        <div class="nav-links">
            
            <div class="nav-link">
                <a href="/"> Home </a>
            </div>
            
            <div class="nav-link">
                <a href="/posts/"> Posts </a>
            </div>
            
            <div class="nav-link">
                <a href="/projects/"> Projects </a>
            </div>
            
            <div class="nav-link">
                <a href="https://followtheprocess.github.io/cv/"> CV </a>
            </div>
            
            <div class="nav-link">
                <a href="https://github.com/FollowTheProcess/"><span data-feather='github'></span>  </a>
            </div>
            
            <div class="nav-link">
                <a href="https://twitter.com/FollowTheProc"><span data-feather='twitter'></span>  </a>
            </div>
            

            <span class="nav-icons-divider"></span>
            <div class="nav-link dark-theme-toggle">
                <a>
                    <span id="theme-toggle-icon" data-feather="moon"></span>
                </a>
            </div>

            <div class="nav-link" id="hamburger-menu-toggle">
                <a>
                    <span data-feather="menu"></span>
                </a>
            </div>

            
            <ul class="nav-hamburger-list visibility-hidden">
                
                <li class="nav-item">
                    <a href="/"> Home </a>
                </li>
                
                <li class="nav-item">
                    <a href="/posts/"> Posts </a>
                </li>
                
                <li class="nav-item">
                    <a href="/projects/"> Projects </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://followtheprocess.github.io/cv/"> CV </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://github.com/FollowTheProcess/"><span data-feather='github'></span>  </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://twitter.com/FollowTheProc"><span data-feather='twitter'></span>  </a>
                </li>
                
                <li class="nav-item dark-theme-toggle">
                    <a>
                        <span id="theme-toggle-icon" data-feather="moon"></span>
                    </a>
                </li>
            </ul>

        </div>
    </nav>
</header>
<main id="content">
    <div class="post container">

    <div class="post-header-section">
        <h1>Automate your Virtual Environments... and everything else.</h1>
        <small role="doc-subtitle">Because why not?</small>
        <p class="post-date">
            March 1, 2021
        </p>

        <ul class="post-tags">
        
            <li class="post-tag"><a href="/tags/python">python</a></li>
        
            <li class="post-tag"><a href="/tags/virtual-environments">virtual environments</a></li>
        
            <li class="post-tag"><a href="/tags/automation">automation</a></li>
        
        </ul>
    </div>

    <div class="post-content">
        <p>
            <p>We all know virtual environments are important! But they are a bit of a pain if you do them a lot&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># Make it</span>
python -m venv .venv

<span style="color:#75715e"># Activate it</span>
source .venv/bin/activate

<span style="color:#75715e"># Install/upgrade seeds</span>
python -m pip install --upgrade pip setuptools wheel

<span style="color:#75715e"># Install what you actually wanted</span>
python -m pip install things i actually wanted

python -m pip install this needs to be automated
</code></pre></div><h2 id="automation">Automation</h2>
<p>I <strong>LOVE</strong> automating things and given that the commands we see above have to be typed <em>every time</em> you start a new project, this should scream automation to you!</p>
<p>There are two approaches that I want to point out here:</p>
<ol>
<li>Easy, low-key, takes 5 mins</li>
<li><strong>AUTOMATE ALL THE THINGS</strong></li>
</ol>
<p>I of course chose option 2, but we&rsquo;ll start with option 1 üòâ</p>
<h2 id="option-1-the-quick-and-easy">Option 1: The quick and easy</h2>
<p>Like most things, 80% of the results can be achieved with 20% of the effort üëç</p>
<h3 id="step-1-create-a-file-to-hold-all-your-custom-stuff">Step 1: Create a file to hold all your custom stuff</h3>
<p>You don&rsquo;t want to clutter up your <code>~/.zshrc</code> too much so it&rsquo;s best to keep this sort of thing separate. I used <code>.my_commands.sh</code> for mine but the name is up to you.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># Go home if you&#39;re not there already</span>
cd $HOME

touch .my_commands.sh

<span style="color:#75715e"># I use VSCode but any editor will do</span>
code ~/.my_commands.sh
</code></pre></div><h3 id="step-2-write-your-function">Step 2: Write your function</h3>
<p>Now in that file, we&rsquo;re going to make a function that you can call from any terminal session. This function will:</p>
<ul>
<li>Create a new virtual environment (if there isnt one already in the current directory)</li>
<li>If there is one, it&rsquo;ll activate it for us</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#!/usr/bin/env bash
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">function</span> venv<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e"># First check if there already is a venv</span>
    <span style="color:#75715e"># If so just activate it</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> -d .venv <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
        echo <span style="color:#e6db74">&#34;Activating venv...&#34;</span>
        source .venv/bin/activate
    <span style="color:#66d9ef">else</span>
        <span style="color:#75715e"># Make a new one</span>
        echo <span style="color:#e6db74">&#34;Creating new venv...&#34;</span>
        python3 -m venv .venv
        <span style="color:#75715e"># Clever recursive call so it now traverses the top branch</span>
        venv
    <span style="color:#66d9ef">fi</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="step-3-source-it-in-each-shell">Step 3: Source it in each shell</h3>
<p>That&rsquo;s your function done, now we just need to do one more thing to make this available to every terminal session.</p>
<p>Open your <code>~/.zshrc</code> (or <code>~/.bashrc</code>, the syntax is the same) and type the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># ~/.zshrc</span>

source ~/.my_commands.sh <span style="color:#75715e"># Or whatever you named it</span>
</code></pre></div><p>Save and close and you&rsquo;re done! That was easy wasn&rsquo;t it! üòÅ</p>
<p>Now this <code>venv</code> command is available in every terminal session because your shell runs <code>~/.zshrc</code> every time it starts up. This is very handy and infinitely better than typing it out yourself.</p>
<p>This is fine, but it&rsquo;s a bit&hellip; plain. We can do better üòè</p>
<h2 id="option-2-automate-all-the-things">Option 2: AUTOMATE ALL THE THINGS</h2>
<p>If you&rsquo;re happy with what we did above or some of it was confusing and you&rsquo;re not quite sure what we did, then stop here. If you want automation at all costs, come with me!</p>
<p>Why don&rsquo;t we make a function that you can call from anywhere and does the following:</p>
<ul>
<li>Go to any project (even get it off GitHub first) and set up its virtual environment</li>
<li>Set up VSCode to use the environment and open the project for you</li>
</ul>
<p>This sounds a bit better, but more complicated&hellip; and it kind of is, but not too much!</p>
<h3 id="find-any-project-by-name-from-anywhere-on-your-computer">Find any project by name from anywhere on your computer</h3>
<p>I&rsquo;m assuming here that you keep all your development projects in one place.</p>
<p>The function we&rsquo;re going to write is going to be called <code>checkout</code> will take a single argument: the name of a project.</p>
<p>You&rsquo;ll use it like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">checkout my_project
</code></pre></div><p>Now to the writing&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Where you keep your projects</span>
PROJECTS_DIR <span style="color:#f92672">=</span> $HOME/Development

<span style="color:#75715e"># As in &#34;check out&#34; a project</span>
<span style="color:#75715e"># Not to be confused with git checkout</span>
<span style="color:#66d9ef">function</span> checkout<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e"># Now we are in PROJECTS_DIR and can find anything we want</span>
    cd PROJECTS_DIR

    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> -d $1 <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
        echo <span style="color:#e6db74">&#34;Project: &#39;</span>$1<span style="color:#e6db74">&#39; found locally&#34;</span> <span style="color:#75715e"># Helpful to say whats going on</span>
        cd $1 <span style="color:#75715e"># Go there</span>
        venv <span style="color:#75715e"># Call your venv function from before</span>
        code . <span style="color:#75715e"># Open the project in VSCode</span>
    <span style="color:#66d9ef">else</span>
        echo <span style="color:#e6db74">&#34;Uh oh, couldn&#39;t find &#39;</span>$1<span style="color:#e6db74">&#39;&#34;</span>
    <span style="color:#66d9ef">fi</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>This is already much better! You can call <code>checkout my_project</code> from anywhere in a terminal and it will find the right project, activate a virtual environment, then open up the project in VSCode, all from one command!</p>
<h3 id="what-if-the-project-is-on-github">What if the project is on GitHub?</h3>
<p>Now we&rsquo;re cooking! Who wants to use their browser to go to the GitHub repo they want, copy the clone link, go back to the terminal, clone it&hellip; blah blah blah when you could just automate it!</p>
<p>To do what we want, we&rsquo;re going to have to install some stuff to make our lives easier:</p>
<ul>
<li><a href="https://cli.github.com">gh</a> - The official GitHub CLI. Get version &gt;=1.7.0.</li>
</ul>
<p>This can be installed with <a href="https://brew.sh">homebrew</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">brew install gh
</code></pre></div><p>Full disclosure: you don&rsquo;t actually <em>need</em> the GitHub CLI you could do this with <code>jq</code> and <code>cURL</code>, <code>gh</code> just makes it so easy, and I use it all the time anyway now it really is great!</p>
<p>What we&rsquo;re going to do with these new tools is:</p>
<ol>
<li>Hit the GitHub API to see what repos you have</li>
<li>If we find a match to what you typed in to <code>checkout</code>, clone it</li>
<li>If not, then you don&rsquo;t have the project. So why not make one?</li>
</ol>
<p>First you&rsquo;ll need to set up the GitHub CLI and authorise it but they&rsquo;ve made this ridiculously easy I think you just fire it up for the first time and it guides you through the auth flow.</p>
<p>Now we can get automating&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Where you keep your projects</span>
PROJECTS_DIR <span style="color:#f92672">=</span> $HOME/Development

<span style="color:#75715e"># As in &#34;check out&#34; a project</span>
<span style="color:#75715e"># Not to be confused with git checkout</span>
<span style="color:#66d9ef">function</span> checkout<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    
    <span style="color:#75715e"># Now we are in PROJECTS_DIR and can find anything we want</span>
    cd PROJECTS_DIR

    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> -d $1 <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
        echo <span style="color:#e6db74">&#34;Project: &#39;</span>$1<span style="color:#e6db74">&#39; found locally&#34;</span> <span style="color:#75715e"># Helpful to say whats going on</span>
        cd $1 <span style="color:#75715e"># Go there</span>
        venv <span style="color:#75715e"># Call your venv function from before</span>
        code . <span style="color:#75715e"># Open the project in VSCode</span>

    <span style="color:#75715e"># Now, instead of just giving up we will search GitHub</span>
    <span style="color:#66d9ef">elif</span> gh repo list | grep -qFe $1; <span style="color:#66d9ef">then</span>

        echo <span style="color:#e6db74">&#34;Project: &#39;</span>$1<span style="color:#e6db74">&#39; found on GitHub. Cloning...&#34;</span>
        gh repo clone $1 <span style="color:#75715e"># See, gh makes everything easy</span>

        <span style="color:#75715e"># Now it will exist locally, so just recurse</span>
        checkout $1
    <span style="color:#66d9ef">else</span>
        <span style="color:#75715e"># No project?</span>
        <span style="color:#75715e"># Let&#39;s make one</span>
        mkdir $1
        touch $1/README.md <span style="color:#75715e"># You can make whatever files you want here</span>
        checkout $1
    <span style="color:#66d9ef">fi</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>This is a bit more complicated so I&rsquo;ll walk through what&rsquo;s happening in our new <code>elif</code> block:</p>
<ol>
<li>
<p><code>gh repo list</code> does exactly what it says on the tin. It will list your (the authorised user&rsquo;s) repos and some info about them. We don&rsquo;t really care about the info for this use case, just the name.</p>
</li>
<li>
<p><code>| grep -qFe $1</code> essentially just means &ldquo;go through whatever is on the left of the pipe (<code>|</code>) and see if <code>$1</code> is in it. And don&rsquo;t forget, <code>$1</code> is the name of our project. The other flags like <code>-q</code>, <code>-F</code> and <code>-e</code> just tweak the behaviour of <code>grep</code>. So in our case, we&rsquo;re asking &ldquo;In my list of repos, is there one called <code>my_project</code>?&rdquo;</p>
</li>
<li>
<p>If the <code>grep</code> bit found a match, we use the GitHub CLI to easily clone it by name (easier than constructing the full clone URL).</p>
</li>
<li>
<p>Once cloned, the project exists locally so now our very top branch <code>if [[ -d $1 ]]</code> will now be true and it will do everything it would do if the project had always been local. Recursive calls like this are useful in bash functions because they avoid repetition.</p>
</li>
<li>
<p>Finally, instead of giving up here if we haven&rsquo;t found a project. Let&rsquo;s just make one and again, do the recursive call.</p>
</li>
</ol>
<p>This is cool. But we can go one step further and automatically set up VSCode to use the environment.</p>
<h3 id="automatically-set-up-vscode">Automatically Set Up VSCode</h3>
<p>If you&rsquo;re not familiar with how VSCode manages it&rsquo;s settings. The quick summary is you have two lots of settings:</p>
<ul>
<li>
<p>User settings - These are global and affect everything</p>
</li>
<li>
<p>Workspace settings - Settings for a particular project</p>
</li>
</ul>
<p>Both of these settings are stored under the hood as JSON files, which means we can access and manipulate them just like any normal text file! This is where <a href="https://stedolan.github.io/jq/">jq</a> comes in.</p>
<p><a href="https://stedolan.github.io/jq/">jq</a> lets you pipe json through a query-like language filter. So for instance if we had a JSON file like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;you&#34;</span>,
    <span style="color:#f92672">&#34;age&#34;</span>: <span style="color:#ae81ff">207</span>,
    <span style="color:#f92672">&#34;occupation&#34;</span>: <span style="color:#e6db74">&#34;Door handle polisher&#34;</span>
}
</code></pre></div><p>You could do something like this to find your name&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">cat that_file.json | jq <span style="color:#e6db74">&#39;.&#34;name&#34;&#39;</span>
</code></pre></div><p>See how that works? <a href="https://stedolan.github.io/jq/">jq</a> actually has really great <a href="https://stedolan.github.io/jq/">docs</a> and interactive sandbox to play with.</p>
<p>I think most people use the JSON view for the settings, but incase you&rsquo;ve never seen them they look like this:</p>
<p><img src="/images/posts/vscode_settings_json.png" alt="VSCode Settings"></p>
<p>And they live here: <code>.vscode/settings.json</code> inside your project.</p>
<p>The setting I&rsquo;m interested in here is:</p>
<p><code>python.defaultInterpreterPath</code>: This controls which verion of the python executable will be used to run your stuff, i.e. this is how we can tell VSCode to use our virtual environment automatically</p>
<h4 id="setting-pythondefaultinterpreterpath">Setting python.defaultInterpreterPath</h4>
<p>Okay so now we know where these settings are kept, what to do? ü§î</p>
<p>This is our function so far:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Where you keep your projects</span>
PROJECTS_DIR <span style="color:#f92672">=</span> $HOME/Development

<span style="color:#75715e"># As in &#34;check out&#34; a project</span>
<span style="color:#75715e"># Not to be confused with git checkout</span>
<span style="color:#66d9ef">function</span> checkout<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    
    <span style="color:#75715e"># Now we are in PROJECTS_DIR and can find anything we want</span>
    cd PROJECTS_DIR

    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> -d $1 <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
        echo <span style="color:#e6db74">&#34;Project: &#39;</span>$1<span style="color:#e6db74">&#39; found locally&#34;</span> <span style="color:#75715e"># Helpful to say whats going on</span>
        cd $1 <span style="color:#75715e"># Go there</span>
        venv <span style="color:#75715e"># Call your venv function from before</span>
        code . <span style="color:#75715e"># Open the project in VSCode</span>
    
    <span style="color:#75715e"># Now, instead of just giving up we will search GitHub</span>
    <span style="color:#66d9ef">elif</span> gh repo list | grep -qFe $1; <span style="color:#66d9ef">then</span>
        echo <span style="color:#e6db74">&#34;Project: &#39;</span>$1<span style="color:#e6db74">&#39; found on GitHub. Cloning...&#34;</span>
        gh repo clone $1 <span style="color:#75715e"># See, gh makes everything easy</span>

        <span style="color:#75715e"># Now it will exist locally, so just recurse</span>
        checkout $1
    <span style="color:#66d9ef">else</span>
        <span style="color:#75715e"># No project?</span>
        <span style="color:#75715e"># Let&#39;s make one</span>
        mkdir $1
        touch $1/README.md <span style="color:#75715e"># You can make whatever files you want here</span>
        checkout $1
    <span style="color:#66d9ef">fi</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>What we want to do is after creating the virtual environment, automatically make VSCode use it. To that end&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
<span style="color:#66d9ef">function</span> code_set_venv<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> -f .vscode/settings.json <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
        echo <span style="color:#e6db74">&#34;Ensuring VSCode is using the correct virtualenv...&#34;</span>
        <span style="color:#75715e"># Current set value for defaultInterpreterPath. &#39;null&#39; if empty or doesn&#39;t exist</span>
        ppath<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>cat .vscode/settings.json | jq <span style="color:#e6db74">&#39;.&#34;python.defaultInterpreterPath&#34;&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>

        <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> $ppath !<span style="color:#f92672">=</span> null <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
            <span style="color:#75715e"># defaultInterpreterPath is already set</span>
            echo <span style="color:#e6db74">&#34;python.defaultInterpreterPath already set in workspace settings. Not overwriting.&#34;</span>
        <span style="color:#66d9ef">else</span>
            ppath_set<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>jq <span style="color:#e6db74">&#39;.&#34;python.defaultInterpreterPath&#34; = &#34;.venv/bin/python&#34;&#39;</span> .vscode/settings.json<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
            echo $ppath_set &gt;.vscode/settings.json
        <span style="color:#66d9ef">fi</span>
    
    <span style="color:#66d9ef">else</span>
        <span style="color:#75715e"># No vscode settings currently</span>
        <span style="color:#75715e"># Make the settings.json and make recursive call to end up in first if branch</span>
        mkdir -p .vscode
        <span style="color:#75715e"># Create empty JSON for jq to work</span>
        echo <span style="color:#e6db74">&#34;{}&#34;</span> &gt;.vscode/settings.json
        <span style="color:#75715e"># Recursive call</span>
        code_set_venv
    <span style="color:#66d9ef">fi</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>This one:</p>
<ul>
<li>
<p>First asks if there are already VSCode workspace settings: <code>if [[ -f .vscode/settings.json ]]</code></p>
</li>
<li>
<p>If there are it looks at what is currently set for <code>python.defaultInterpreterPath</code>. The assumption being that if someone already set it explicitly, we should probably leave it alone.</p>
</li>
<li>
<p>If it&rsquo;s empty or not set at all (represented in JSON by <code>null</code>) then we can do what we like! i.e. set it to our virtualenv&rsquo;s python. This bit is done by the <code>ppath_set</code> line.</p>
</li>
<li>
<p>If there is no workspace settings file yet, we create one, dump a placeholder set of brackets (needed so <code>jq</code> knows it&rsquo;s valid JSON) and then just call the function again! Now the settings exist, it will traverse the top branch.</p>
</li>
</ul>
<p>Now we just need to weave this into our main <code>checkout</code> function in the right place:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Where you keep your projects</span>
PROJECTS_DIR <span style="color:#f92672">=</span> $HOME/Development

<span style="color:#75715e"># As in &#34;check out&#34; a project</span>
<span style="color:#75715e"># Not to be confused with git checkout</span>
<span style="color:#66d9ef">function</span> checkout<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e"># Now we are in PROJECTS_DIR and can find anything we want</span>
    cd PROJECTS_DIR

    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> -d $1 <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
        echo <span style="color:#e6db74">&#34;Project: &#39;</span>$1<span style="color:#e6db74">&#39; found locally&#34;</span> <span style="color:#75715e"># Helpful to say whats going on</span>
        cd $1
        venv
        code_set_venv <span style="color:#75715e"># Here is a good place</span>
        code . 
    
    <span style="color:#75715e"># Now, instead of just giving up we will search GitHub</span>
    <span style="color:#66d9ef">elif</span> gh repo list | grep -qFe $1; <span style="color:#66d9ef">then</span>
        echo <span style="color:#e6db74">&#34;Project: &#39;</span>$1<span style="color:#e6db74">&#39; found on GitHub. Cloning...&#34;</span>
        gh repo clone $1 <span style="color:#75715e"># See, gh makes everything easy</span>
        <span style="color:#75715e"># Now it will exist locally, so just recurse</span>
        checkout $1
    <span style="color:#66d9ef">else</span>
        <span style="color:#75715e"># No project?</span>
        <span style="color:#75715e"># Let&#39;s make one</span>
        mkdir $1
        touch $1/README.md <span style="color:#75715e"># You can make whatever files you want here</span>
        checkout $1
    <span style="color:#66d9ef">fi</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>And that&rsquo;s it! Now when we call <code>checkout</code>, we&rsquo;ll end up with VSCode open in the root of our project, whether or not we had it on our computer in the first place, and VSCode will be set up to use the right environment!</p>
<p>You can even inject stuff like installing from <code>requirements.txt</code> or whatever you want so you can just get to codingTM üòÅ</p>

        </p>
    </div>
</div>



    

        </main><footer class="footer">
    <span>&copy; 2022 Tom Fleet</span>
    <span>
        Made with &#10084;&#65039; using <a target="_blank" href="https://github.com/526avijitgupta/gokarna">Gokarna</a>
    </span>
</footer>
</body>
</html>
